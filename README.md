Modified version from the original author: jeremykendall/slim-auth
